<% @page_title = "Locations" %>

<%= link_to("<< Back to Index", root_path) %>

<div class="tracks index">
  <h1>Location Tracks</h1>

  <p>&nbsp;</p>

  <div style='width: 100%'>
    <div id="custom_style" style='width: 100%; height: 500px;'></div>
  </div>

  <script>
  mapStyle = [
    {
        "featureType": "water",
        "elementType": "geometry",
        "stylers": [
            {"visibility": "on"},
            {"color": "#aee2e0"}
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "geometry.fill",
        "stylers": [
            {"color": "#abce83"}
        ]
    },
    {
        "featureType": "poi",
        "elementType": "geometry.fill",
        "stylers": [
            {"color": "#769E72"}
        ]
    },
    {
        "featureType": "poi",
        "elementType": "labels.text.fill",
        "stylers": [
            {"color": "#7B8758"}
        ]
    },
    {
        "featureType": "poi",
        "elementType": "labels.text.stroke",
        "stylers": [
            {"color": "#EBF4A4"}
        ]
    },
    {
        "featureType": "poi.park",
        "elementType": "geometry",
        "stylers": [
            {"visibility": "simplified"},
            {"color": "#8dab68"}
        ]
    },
    {
        "featureType": "road",
        "elementType": "geometry.fill",
        "stylers": [
            {"visibility": "simplified"}
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.text.fill",
        "stylers": [
            {"color": "#5B5B3F"}
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.text.stroke",
        "stylers": [
            {"color": "#ABCE83"}
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.icon",
        "stylers": [
            {"visibility": "on"}
        ]
    },
    {
        "featureType": "road.local",
        "elementType": "geometry",
        "stylers": [
            {"color": "#A4C67D"}
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "geometry",
        "stylers": [
            {"color": "#9BBF72"}
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "geometry",
        "stylers": [
            {"color": "#EBF4A4"}
        ]
    },
    {
        "featureType": "transit",
        "stylers": [
            {"visibility": "on"}
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "geometry.stroke",
        "stylers": [
            {"visibility": "on"},
            {"color": "#87ae79"}
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "geometry.fill",
        "stylers": [
            {"color": "#7f2200"},
            {"visibility": "off"}
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "labels.text.stroke",
        "stylers": [
            {"color": "#ffffff"},
            {"visibility": "on"},
            {"weight": 4.1}
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "labels.text.fill",
        "stylers": [
            {"color": "#495421"}
        ]
    },
    {
        "featureType": "administrative.neighborhood",
        "elementType": "labels",
        "stylers": [
            {"visibility": "off"}
        ]
    }
  ]

  handler = Gmaps.build('Google');
  handler.buildMap({
      internal: {id: 'custom_style'},
      provider: {
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        styles: mapStyle
      }
    },
      function(){
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
    });
  </script>

  <p>&nbsp;</p>

  <table class="listing" summary="Track list"

    <tr class="header">
      <th>Track</th>
      <th>#</th>
      <th>Location</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>

    <% @tracks.each do |track| %>
    <tr>
      <td><%= track.name %></td>
      <td><%= track.track_number %></td>
      <td><%= track.location_finished %></td>
      <td class="center"><%= track.latitude %></td>
      <td class="center"><%= track.longitude %></td>
      </td>
    </tr>
  <% end %>
  </table>

</div>
